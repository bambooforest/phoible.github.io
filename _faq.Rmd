---
title: "PHOBILE frequently asked questions"
layout: default
bibliography: bib/faq.bibtex
output: html_document
csl: bib/phoible.csl
---

```{r opts, echo=FALSE}
knitr::opts_chunk$set(fig.path = "images/faq/")
```


# Overview

This FAQ answers questions regarding the editorial principles and design
decisions that went into the creation of PHOIBLE, including:

* How are PHOIBLE inventories created?
* Why do some phonological inventories combine more than one doculect?
* Where do the language codes in PHOIBLE come from?
* Why do some languages have multiple inventories in PHOIBLE?
* Why are multiple inventories sometimes linked to the same document?
* How can I filter or sample inventories?
* What kind geographic coverage does PHOIBLE have?
* What are the different "sources" in PHOIBLE?
* What phonological feature set does PHOIBLE use?
* How is PHOIBLE used in academic research and/or industry?


We appreciate and welcome feedback regarding these FAQs via
[our issue tracker](https://github.com/phoible/dev/issues)
or by contacting the editors directly.

When relevant, we provide [R](https://www.r-project.org/) code snippets to
elucidate the questions raised in this FAQ. To run these code snippets
requires the following
[R packages](https://cran.r-project.org/web/packages/available_packages_by_name.html):

```{r, warning=FALSE, message=FALSE}
library(readr)
library(stringr)
library(dplyr)
library(knitr)
library(ggplot2)
```

To start off we'll load the most-up-to-date
[PHOIBLE data](https://github.com/phoible/dev/blob/master/data/phoible.csv):

```{r}
url_ <- "https://github.com/phoible/dev/blob/master/data/phoible.csv?raw=true"
col_types <- cols(InventoryID='i', Marginal='l', .default='c')
phoible <- read_csv(url(url_), col_types=col_types)
```

# How are PHOIBLE inventories created?

For the most part, every phonological inventory in PHOIBLE is based on
one-and-only-one language description (usually a research article, book
chapter, dissertation, or descriptive grammar). The technical term for this in
comparative linguistics is "doculect" (from "documented lect"), in which
[lect](https://en.wikipedia.org/wiki/Variety_(linguistics)) means a specific
form of a language or dialect, i.e. an instance of documentation of an instance
of linguistic behavior at a particular time and place [@CysouwGood2013].
A brief explanation and some history of why linguists use the term "doculect",
which has gained broad acceptance in light of the issues of language
identification and the use of "language codes", is given in
[this blog post](https://dlc.hypotheses.org/623) by Michael Cysouw.

Contributors to PHOIBLE start with a doculect, extract the contrastive phonemes
and allophones, and (if necessary) adapt the authors' choice of symbols to
align with PHOIBLE's [symbol guidelines](http://phoible.github.io/conventions/).
If the authors have not provided ISO 639-3 and Glottolog codes, these are
determined before adding the inventory to PHOIBLE.
Each inventory is then given a unique numeric ID.
Doculects are tracked in PHOIBLE using BibTeX keys.


# Why do some phonological inventories combine more than one doculect?

An exception to the "one doculect per inventory" rule arises for inventories
that were originally part of a curated phonological database such as
UPSID [@Maddieson1984;@MaddiesonPrecoda1990] or SPA [@CrothersEtAl1979]. In
those collections, inventories were often based on multiple descriptions of
linguistic behavior, written by different linguists; those descriptions were
believed to be describing the same language, and disagreements between the
descriptions were adjudicated by the experts who compiled the collection.

We can quickly see how many of PHOIBLE's inventories are based on multiple
doculects by looking at the mapping table between PHOIBLE inventory IDs and
BibTeX keys:

```{r}
url_ <- "https://github.com/phoible/dev/blob/master/mappings/InventoryID-Bibtex.csv?raw=true"
id_to_bibtex_mapping <- read.csv(url(url_), stringsAsFactors=FALSE)

id_to_bibtex_mapping %>%
    group_by(InventoryID) %>%
    summarise(references=n(), .groups="drop") %>%
    select(references) %>%
    table() %>%
    as.data.frame(responseName="n_inventories") %>%
    select("n_inventories", "n_doculects_used_in_inventory"=".") %>%
    kable()
```

Clearly, the majority of inventories in PHOIBLE represent a phonological
description from a single doculect. But it seems strange that a single
phonological inventory in PHOIBLE could be based on 11 different doculects.
Let's examine it:

```{r}
id_to_bibtex_mapping %>%
    group_by(InventoryID) %>%
    summarise(references=n(), .groups="drop") %>%
    filter(references == 11) %>%
    pull(InventoryID) ->
    this_inventory_id

phoible %>%
    filter(InventoryID == this_inventory_id) %>%
    select(Source, LanguageName, Glottocode, ISO6393) %>%
    distinct() %>%
    kable()
```

As we can see, this inventory represents a description of
[Hausa](https://glottolog.org/resource/languoid/id/haus1257) and was added to
PHOIBLE from the UPSID database [@Maddieson1984;@MaddiesonPrecoda1990].

Maddieson's work on UPSID involved "typologizing" phonological inventories from different doculects, so that they were comparable across all entries in his database (cf [@Hyman2008]). Maddieson's work was groundbreaking at the time because he was the first typologist to generate a stratified language sample aimed at being genealogically balanced, i.e. for each language family he chose one representative language. This allowed Maddieson to make statements about the cross-linguistic distribution of contrastive speech sounds with some level of statistical confidence. In fact, much about what we know about the distribution of the sounds of the world's languages is due to Maddieson's original language sample and his meticulous curation of the data. Regarding Hausa, consider the fact that the [Glottolog](https://glottolog.org/) reference catalog has [more than 1400 references](https://glottolog.org/resource/languoid/id/haus1257) related to Hausa, so perhaps it is unsurprising that Maddieson consulted 11 different sources when preparing the Hausa entry for UPSID.


# Where do the language codes in PHOIBLE come from?

Since most PHOIBLE inventories (aside from some UPSID or SPA ones, as mentioned
above) are based on a single document, it is fairly straightforward to link
each PHOIBLE inventory to [the Glottolog](https://glottolog.org/), which
provides links between linguistic description documents and unique identifiers
for dialects, languages, and groupings of dialects and languages at various
levels (the preferred term for any of these levels of specificity / grouping is
"languoid"; see [@CysouwGood2013]). Thus in PHOIBLE each inventory typically
corresponds to a single languoid, and in most cases that
languoid is a "leaf node" in the Glottolog tree, i.e., it represents a
particular dialect known to be used at a particular place and time (rather than
a group of dialects, a language, or a language family). However, in the few
cases where multiple document sources were consulted for an inventory, it may
not be possible to link that inventory to a unique Glottolog leaf node.
In such cases, the inventory in PHOIBLE is linked to the lowest possible
Glottolog node that dominates the leaf nodes of each source document.

<!--
For example, XXX TODO GIVE A REAL-LIFE EXAMPLE HERE XXX.
SPA/UPSID might link to different level Glottolog / ISO entries.
-->

In addition to providing Glottolog languoid codes ("glottocodes") for each
inventory, PHOIBLE also includes
[ISO 639-3](https://en.wikipedia.org/wiki/ISO_639-3) language codes
("isocodes") for each inventory. The link between glottocodes and isocodes is
maintained and provided by Glottolog. This situation can result in two possible
problems:

* When there are
  [updates to ISO 639-3](https://iso639-3.sil.org/code_changes/submitting_change_requests),
  the Glottolog may not update its mapping immediately, so the two can get out
  of sync temporarily. Such problems are typically resolved with new version
  releases of Glottolog.

* In some cases, the editors of the Glottolog do not agree with the language
  classification choices of ISO 639-3 (see also the above-mentioned
  [blog post by Cysouw](https://dlc.hypotheses.org/623)). This disagreement
  results in cases where PHOIBLE must choose whether to accept the official
  ISO 639-3 code assignment, or use the isocode that the Glottolog associates
  with the glottocode for that inventory. In such cases, PHOIBLE policy is to
  report the ISO 639-3 version of the isocode. Consequently, there are a few
  languoids for which PHOIBLE and the Glottolog will report different isocodes
  for the same glottocode. If this is a problem for your analysis, you can
  always download a glottocode-isocode mapping from the Glottolog and merge it
  into the PHOIBLE dataset before performing your isocode-based analyses.


## Missing isocodes

There are many cases of languages reported in the Glottolog for which there exists no isocode. For example, [Pisamira](https://en.wikipedia.org/wiki/Pisamira_language) is a Tucanoan language classifed in the Glottolog as [[pisa1245](https://glottolog.org/resource/languoid/id/pisa1245)] based on an existing grammatical sketch and word lists. However, Pisamira is classified as a dialect of [Tucanoan](https://en.wikipedia.org/wiki/Tucanoan_languages), and as such, it has not been assigned an isocode.

When no isocode exists for a particular phonological inventory in PHOIBLE, as in the Pisamira example above, then we use the standard isocode `mis` ("missing") to denote that the language has not yet been included in the ISO 639-3 standard. In PHOIBLE these are these inventories with missing isocodes:

```{r}
phoible %>%
    filter(ISO6393 == "mis") %>%
    select(InventoryID, LanguageName, ISO6393, Glottocode) %>%
    distinct() %>%
    kable()
```

Many of these inventories come from
[Erich Round's](https://languages-cultures.uq.edu.au/profile/1160/erich-round)
[contribution of Australian phonemic inventories](https://zenodo.org/record/3464333#.XyK5qxMzY3E)
to PHOIBLE. Unfortunately, some of these languages are extinct and have no
representation in the [Ethnologue](https://www.ethnologue.com/), and hence, no
code assigned in ISO 639-3.

For users, it is important to note that multiple phonological inventories in PHOIBLE may have the same isocode (e.g. "mis") or the same Glottolog code (e.g. two different descriptions of the same language or dialect). In essense, this means that any programmatic code that groups on isocodes or glottocodes, for example to calculate segment inventory counts, collapses phonological inventories from different doculects into a single source. Therefore, **most analyses of inventory properties should be done on the level of inventory IDs** rather than on isocodes or glottocodes. See also the "How can I filter or sample inventories?" section below.


# Why do some languages have multiple entries in PHOIBLE?

It is not uncommon that phonological descriptions of a particular language's
speech sounds have different sets of contrastive phonemes when analyzed by
different linguists (or sometimes even by the same linguist throughout their
career). For example, this entry for the
[Kabardian language](https://en.wikipedia.org/wiki/Kabardian_language)
represents the phonological inventory in a single linguistic description:

```{r}
phoible %>%
    filter(InventoryID == 4) %>%
    pull(Phoneme)
```

However, PHOIBLE currently contains no less than
[five entries for Kabardian](https://phoible.org/languages/kaba1278).

```{r}
phoible %>%
    filter(ISO6393 == "kbd") %>%
    group_by(InventoryID) %>%
    summarise(Phonemes=str_c(Phoneme, collapse=" "), .groups="drop") %>%
    kable()
```

The differences among them can be due to a variety of reasons, but the main
reason is that these phonological descriptions represent different doculects
(i.e., different instances of linguistic behavior at different places, times,
or with different speakers). This should probably not surprise most linguists,
since it has long been known that phoneme analysis is a non-deterministic
process [@Chao1934;Hockett1963]. See also [@Moran2012] chapter 2.3.3 for a
general discussion, and [@Hyman2008] page 99 for a detailed discussion of
Kabardian in particular.

In light of the above discussion, it
should come as no surprise that PHOIBLE can contain multiple inventories for
"the same" languoid, depending on what kind of languoid you're interested in.
All it takes is the existence of two or more descriptive documents associated
with the same group of speakers, where "group of speakers" is ultimately
determined by your desired level of granularity. To give a concrete example, one
researcher may be interested in comparing "languages", and so might wish to
treat all inventories of "English" as duplicates in some sense, regardless of
the regional dialect, sociolect, etc., represented in the doculect and encoded in
the phonological inventory. Such a researcher might *filter* or *sample* the
PHOIBLE dataset in order to include only one inventory for each isocode (how she
might choose to implement that filter is a separate question; see "Filtering and
sampling inventories" for examples). Other researchers may not care about
"duplicates" in that sense, and may choose to include all inventories in their
analysis (or, they may filter the dataset to include only inventories with a
particular feature of interest such as breathy-voiced vowels).

Because a key principle of PHOIBLE is to remain as faithful as possible to the description of speech sounds in the original doculects (though not necessarily to the exact *symbols* used in the document, if they don't reflect the textual descriptions; see for example our [IPA conventions](http://phoible.github.io/conventions/)), it may arise that linguists disagree on their phonological analysis of a particular languoid, and hence there may be two PHOIBLE inventories (with unique inventory IDs) that link to the same glottocode (but different documents), but nonetheless contain different sets of phonemes.

For example, [Barbareño](https://en.wikipedia.org/wiki/Barbare%C3%B1o_language) has two inventories from different doculects that have slightly different phoneme inventories:

* https://phoible.org/inventories/view/1239
* https://phoible.org/inventories/view/862

Inventory (PH) 1239 has 44 phonemes:

```{r}
phoible %>% filter(InventoryID == 1239) %>% pull(Phoneme) %>% cat("\n")
```

Inventory (PH) 862 has 40 phonemes:

```{r}
phoible %>% filter(InventoryID == 862) %>% pull(Phoneme) %>% cat("\n")
```

The difference between these two inventories is reflected clearly in their sources, i.e. [@Beeler1970] posits four additional segments (`sʼ ʃʰ ʃʼ χʼ`) whereas [@Wash2001] does not.

Recall that [ISO 639-3](https://en.wikipedia.org/wiki/ISO_639-3) includes (iso)codes for cataloging languages and Glottolog has (glotto)codes for languiods (i.e. language families, languages, and dialects). Below is a summary of the number of isocodes that are represented by multiple
inventories in PHOIBLE:

```{r stemplot_inv_per_iso}
phoible %>%
    group_by(ISO6393) %>%
    summarise(y=n_distinct(InventoryID), .groups="drop") %>%
    count(y) %>%
    ggplot(aes(y=as.factor(y), x=n)) +
    geom_point() +
    geom_segment(aes(x=0, xend=n, y=as.factor(y), yend=as.factor(y))) +
    scale_x_log10() +
    theme_light() +
    labs(title="Prevalence of multiple inventories per ISO code",
         x="Number of ISO codes having N inventories (log scale)",
         y="N inventories")
```

So most ISO 639-3 codes have only 1 inventory (the long, bottom line).

Here is the same representation, for glottocodes instead of isocodes:

```{r stemplot_inv_per_glotto}
phoible %>%
    group_by(Glottocode) %>%
    summarise(y=n_distinct(InventoryID), .groups="drop") %>%
    count(y) %>%
    ggplot(aes(y=as.factor(y), x=n)) +
    geom_point() +
    geom_segment(aes(x=0, xend=n, y=as.factor(y), yend=as.factor(y))) +
    scale_x_log10() +
    theme_light() +
    labs(title="Prevalence of multiple inventories per glottocode",
         x="Number of glottocodes having N inventories (log scale)",
         y="N inventories")
```

Again, most glottocodes are represented by just one or two inventories in
PHOIBLE. Let's see the few glottocodes that have the most inventories:

```{r}
phoible %>%
    group_by(Glottocode) %>%
    summarise(n_inventories=n_distinct(InventoryID), .groups="drop") %>%
    arrange(desc(n_inventories)) %>%
    filter(n_inventories > 5) %>%
    kable()
```


# Why are multiple inventories sometimes linked to the same document?

Occasionally, a single document may provide information about multiple phonological inventories. For example, a dissertation that describes and compares three related dialects or languages spoken in a particular region. In that case, three phonological inventories in PHOIBLE corresponding to three doculects might all be linked to the same document, but each inventory is still linked to only one document (it just happens to be *the same document* for those three inventories). One example is [@Terrill1998], a grammar of [Biri](https://en.wikipedia.org/wiki/Biri_language), which contains a chapter describing its dialects, [many of which appear in PHOIBLE](https://phoible.org/languages/biri1256).


# What are the different "sources" in PHOIBLE?

TODO


# How can I filter or sample inventories?

If multiple inventories per isocode/glottocode are problematic for your
analysis or research question, one approach is to select one inventory from each
isocode/glottocode via random sampling:

```{r}
phoible %>%
    group_by(Glottocode) %>%
    sample_n(1) ->
    one_inv_per_glottocode

phoible %>%
    group_by(ISO6393) %>%
    sample_n(1) ->
    one_inv_per_isocode

message("Picking one inventory per glottocode reduces PHOIBLE from ",
        n_distinct(phoible$InventoryID), " inventories\nto ",
        nrow(one_inv_per_glottocode),
        " inventories. Picking one per ISO 639-3 code yields ",
        nrow(one_inv_per_isocode), " inventories.")
```

Another approach is to only use only inventories from a data source that already
provides a one-inventory-per-language sample. For example, UPSID represents a
"quota" sample (one language per family, for some definition of "family"). To do
this, you can filter the PHOIBLE data by the `Source` column:

```{r}
phoible %>%
    filter(Source == "upsid") ->
    upsid

# show that there is exactly one inventory per ISO 639-3 code:
upsid %>%
    group_by(ISO6393) %>%
    summarise(InventoryID=n_distinct(InventoryID), .groups="drop") %>%
    select(InventoryID) %>%
    distinct() %>%
    kable()
```

However, note that the state of knowledge of linguistic genealogical groupings
has changed since UPSID was published. A quota sample that reflects current
understanding can also be achieved. Here, we choose one leaf node from within
each top-level Glottolog family node that has representation in PHOIBLE:

```{r}
# TODO XXX EXAMPLE OF QUOTA SAMPLE USING GLOTTOLOG XXX
# caveat: every Isolate will be included
```

Another approach is to select inventories based on properties of the inventories themselves, such as whether they include representations of allophones or contrastive tone, etc. For example, one might wish to include phonological inventories from sources other than UPSID, when available, since it does not include tone in its inventories.

```{r}
# TODO XXX EXAMPLE OF PREFERENTIAL SOURCE ORDERING HERE XXX
```

If you're inclined to be a "splitter", you might prefer to pick the largest
inventory for a given isocode...

```{r}
# TODO XXX EXAMPLE OF PICKING AMONG DUPLICATES BY INVENTORY SIZE XXX
```


# What kind geographic coverage does PHOIBLE have?

TODO

```{r}
nrow(phoible %>% select(ISO6393) %>% distinct())
```

```{r}
# https://github.com/bambooforest/phoible-scripts/blob/master/segment-counts/segment-counts.md
```


# What phonological feature set does PHOIBLE use?

TODO


# How is PHOIBLE used in academic research and/or industry?

The data in PHOIBLE have been used in many published research papers pertaining to very different scientific fields and industrial applications:

* https://scholar.google.com/scholar?oi=bibs&hl=en&cites=576981116309388928&as_sdt=5

# References
